import dot
import operatorApprox
import random

assert dot(@[2, 3, 4], @[5, 6, 7]) == 2 * 5 + 3 * 6 + 4 * 7

# vector @ vector
let a = random(100)
let b = random(100)
var cTrue = 0.0

for i in 0 .. len(a) - 1:
  cTrue += a[i] * b[i]

let cPred = dot(a, b)
assert cPred ~ cTrue

# matrix @ matrix
let d = @[@[-0.006069130479088473, -0.04032989121465628, 1.6871861825627263,
    -1.3453583287635447, -1.7267988737025606], @[0.3757435581181791,
    -2.324673522705163, -0.11801128700074877, 0.5506741785021977,
    -0.8009029417928255], @[-0.7467512166251523, 1.2859005138554493,
    -0.19423881563434492, 0.4127011044720668, 0.7768504771499575], @[
    1.9366629174438066, 1.8715093954602209, -1.5006580061960806,
    -0.2981362145939592, -0.45478069958711415], @[0.21732103377087683,
    0.028737827804264777, -1.390408155706021, 0.34709576186431296,
    -0.9082908887977016], @[2.0125570288099506, 0.15318500144368086,
    -0.7852412624699023, 0.2882891000162355, 1.6182890973298871], @[
    0.34070958608396346, 0.957949163230078, -0.16471772382876468,
    -0.3608206252316308, -1.5126186401893684]]

let e = @[@[-0.8536638233670647, -0.688131078081582], @[1.4772261945863097,
    1.65538276117833], @[-0.743716039707107, 0.5680847117995811], @[
    2.595623846377188, 0.5967000379863922], @[0.2496805263809504,
    -0.25742286582977625]]

let fTrue = @[@[-5.232375012342823, 0.5376217757976622], @[-2.4376872558034846,
    -3.6390676687906236], @[3.946680208356468, 2.5784558499480745], @[
    1.3400477085033304, 0.8520586388457155], @[1.5651495038086225,
    -0.45091597104497794], @[0.2445836270415479, -1.8219692838030543], @[
    -0.06746667508530735, 1.4318269999251418]]

let fPred = dot(d, e)
assert fPred ~ fTrue

# matrix @ vector
let g = @[@[-1.8908035001943024, -0.9564094294203475, -0.0007719911960800182],
    @[-1.6232601205542698, 0.9490163962802726, 0.5310042708401708], @[
    0.6021787351320768, 0.8942276961882147, -0.34672124965817586], @[
    -0.17595706810024164, 0.21008320847747836, -1.0175027226897846], @[
    -1.2431729011873858, -0.5631885755152881, 1.886779691989026], @[
    0.7125776013226142, 1.0755900158204759, -0.5508003754044379], @[
    0.7613524596771397, -0.27958294068988593, 0.864056743286904], @[
    -0.0819965338747103, -0.9257921692574937, -0.7475596208985843]]

let h = @[-1.0542874007452754, -0.11633628121830596, -0.6285257377860602]

let iTrue = @[2.1052006402168852, 1.267227803776811, -0.5209773489359151,
    0.8005956702274052, 0.19029119322273758, -0.5301995173599017,
    -1.313240568215516, 0.6640115929856858]

let iPred = dot(g, h)
assert iPred ~ iTrue

# vector @ matrix
let j = @[0.5400873025947179, -1.1480224759650972, -1.2800324962373641,
    0.6699813743552515, 2.5208525922828815, -1.2182093279310664]

let k = @[@[0.7067853751294567, 0.6128807319364946, -0.16815668644832346,
    0.19638760540546135, -0.07405546817415498], @[-0.2646419342756757,
    0.09493027035652427, -0.6612152965392805, -0.3713237230801755,
    -0.6106294007273062], @[1.2219134388201764, 0.8286107977042837,
    -0.5064703690942608, -0.027825806358904272, 0.4909642609424736], @[
    0.16049100079249226, -0.7916731190673015, 2.233173606863587,
    -1.2956143003441951, 0.7748598005612614], @[1.3503284902686694,
    -0.6151989095411986, 0.7769069202209647, -0.7918832579353823,
    -0.9467866274679267], @[1.0822805129604802, 1.0184677240622586,
    -1.2950115308864911, 0.07596249505281592, 0.9857221346851869]]

let lTrue = @[1.314512626202778, -4.160560622378242, 6.348816934309949,
    -2.388824264782043, -3.0358141393262876]

let lPred = dot(j, k)
assert lPred ~ lTrue
